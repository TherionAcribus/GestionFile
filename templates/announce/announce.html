<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Écran d'Affichage</title>
        <!-- Script SocketIO -->
        <script src="https://unpkg.com/htmx.org"></script>
        <script src="https://unpkg.com/htmx.org@1.9.12/dist/ext/ws.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
        <link rel="stylesheet" href="../static/css/display.css">
</head>
<body>

    <div id="full_page">
        <button onclick="initializeAudio()">Activer le Son</button>
        <audio id="player" src="" hidden></audio>
        <div id="div_title_area"  hx-trigger="refresh" hx-get="/current_patients" hx-swap="innerHTML">
            <h1 id="text_title">Bienvenue à la Pharmacie Sainte-Agathe</h1>
        </div>

        <div id="div_center">
            <div id="left_side">
                <div id="div_calling"
                        hx-trigger="refresh_calling, load" 
                        hx-get="/announce/patients_calling" 
                        hx-swap="innerHTML"">
                    <!-- PATIENT CALLING -->
                </div>

                <div id="div_ongoing"
                        hx-trigger="refresh_ongoing, load" 
                        hx-get="/announce/patients_ongoing" 
                        hx-swap="innerHTML">
                    <!-- PATIENT ON GOING -->
                </div>
            </div>

            <div id="div_pub">
                <!-- PUB / ANNONCES -->
            </div>

        </div>

        <div id="div_footer">
            <!-- FOOTER -->
        </div>

    </div>




    </div>

    <script type="text/javascript">


    let currentIndex = 0; // Commencer par la première image après l'image de départ
    const changeInterval = 30000; // 30 secondes, ajustable

    function updateImage() {
        currentIndex++; // Passer à la prochaine image
        // Utiliser HTMX pour charger la prochaine image
        htmx.ajax('GET', `/next_image/${currentIndex}`, '#div_pub');
    }

    // Définir un intervalle pour mettre à jour l'image
    setInterval(updateImage, changeInterval);

    </script>

<script src="../static/js/announce.js"></script>
</body>
</html>